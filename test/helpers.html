
<script>
  function findElementInList(container, selector) {
    var i = 0;
    var children = container._children;
    var ms = Polymer.DomApi.matchesSelector;

    for (; i < children.length; i++) {
      if (children[i].nodeType === Node.ELEMENT_NODE && ms.call(children[i], selector)) {
        return children[i];
      }
    }
    return null;
  }

  function buildItem(index) {
    return {
      index: index,
      name: 'name-'+index
    };
  }

  function buildDataSet(size) {
    var data = [];
    while (data.length < size) {
      data.push(buildItem(data.length));
    }
    return data;
  }

  function getGridRowFromIndex(grid, index) {
    return Math.floor(index / grid._itemsPerRow);
  }

  function getNthItemFromGrid(grid, n, itemSize) {
    itemSize = itemSize || 100;
    var gridRect = grid.getBoundingClientRect();
    var x = gridRect.left + ((n % grid._itemsPerRow) * itemSize) + (itemSize / 2);
    var y = gridRect.top + (Math.floor(n / grid._itemsPerRow) * itemSize) + (itemSize / 2);
    return document.elementFromPoint(x, y);
  }

  function getFirstItemFromTable(table) {
    var tableRect = table.getBoundingClientRect();
    return document.elementFromPoint(tableRect.left + 100, tableRect.top + 1);
  }

  function getLastItemFromList(list) {
    var listRect = list.getBoundingClientRect();
    return document.elementFromPoint(listRect.left + 100, listRect.top + listRect.height - 1);
  }

  function isFullOfItems(list) {
    var listRect = list.getBoundingClientRect();
    var listHeight = listRect.height - 1;
    var item, y = listRect.top + 1;
    // IE 10 & 11 doesn't render propertly :(
    var badPixels = 0;
    while (y < listHeight) {
      item = document.elementFromPoint(listRect.left + 100, y);
      if (!item || (item.parentNode && !item.parentNode._templateInstance)) {
        badPixels++;
      }
      y++;
      if (badPixels > 2) {
        return false;
      }
    }
    return true;
  }

  function checkRepeatedItems(list) {
    var listRect = list.getBoundingClientRect();
    var listHeight = list.offsetHeight;
    var listItems = {};

    return function() {
      var itemKey;
      var y = listRect.top;
      while (y < listHeight) {
        item = document.elementFromPoint(listRect.left + 100, y + 2);
        itemKey = item.textContent || item.innerText;

        if (item.parentNode && item.parentNode._templateInstance) {
          if (listItems[itemKey] && listItems[itemKey] != item) {
            return true;
          }
          listItems[itemKey] = item;
        }
        y += item.offsetHeight;
      }
      return false;
    };
  }

  function getNthItemRowStart(grid, n) {
    return n - (n % grid._itemsPerRow);
  }
</script>